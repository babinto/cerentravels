// index.js

import { initializeApp } from "firebase/app";
import {
  getFirestore,
  collection,
  addDoc,
  getDocs
} from "firebase/firestore";

// Firebase config - senin verdiğin gibi
const firebaseConfig = {
  apiKey: "AIzaSyCD_PLUZ_SAdlzOsqWWjzhi8voYUGd7ftE",
  authDomain: "ceren-travels.firebaseapp.com",
  projectId: "ceren-travels",
  storageBucket: "ceren-travels.firebasestorage.app",
  messagingSenderId: "579239744378",
  appId: "1:579239744378:web:2b034208cf0842cb6cfcc3"
};

// Firebase'i başlat
const app = initializeApp(firebaseConfig);

// Firestore referansı al
const db = getFirestore(app);

// Şehri Firestore'a eklemek için fonksiyon
async function addCity(cityName, coords) {
  try {
    const docRef = await addDoc(collection(db, "cities"), {
      name: cityName,
      location: coords,
      createdAt: new Date()
    });
    console.log("City added with ID: ", docRef.id);
  } catch (e) {
    console.error("Error adding city: ", e);
  }
}

// Şehirleri Firestore'dan çekmek için fonksiyon
async function getCities() {
  try {
    const querySnapshot = await getDocs(collection(db, "cities"));
    const cities = [];
    querySnapshot.forEach((doc) => {
      cities.push({ id: doc.id, ...doc.data() });
    });
    console.log("Cities:", cities);
    return cities;
  } catch (e) {
    console.error("Error fetching cities: ", e);
    return [];
  }
}

// Örnek kullanım
(async () => {
  await addCity("Ankara", { lat: 39.9334, lng: 32.8597 });
  await getCities();
})();
